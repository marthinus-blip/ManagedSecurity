namespace ManagedSecurity.Common;

public partial class Bindings {
    /*
----|0123456|70|123|45670123|456701234567|
    ----|----------------HEAD----------------|
    ----|-ECode-|-S|V--|----L---|-----KI-----|
    ----|------7|-9|-12|------20|----------32|
    ----|------7|-2|--3|-------8|----------12|
    ----|0123456|01|012|01234567|012345670123|
    ----|1111111|XX|XXX|XXXXXXXX|XXXXXXXXXXXX|
    _________________________________________.
    VX==NULL:V<>111--------------------------|
    =============================================.
        _________________________________________.
        LX==NULL:L<>1XXXXXXX---------------------|
        =========================================.
        _________________________________________.
        LX1<>NULL:L==1XXXXXXX--------------------|---LX1--|
        -----------------------------------------|-------8|
        -----------------------------------------|-------1|
        =========================================.
        _________________________________________.
        LX2<>NULL:L==11XXXXXX--------------------|-------LX2------|
        -----------------------------------------|--------------16|
        -----------------------------------------|-------1-------2|
        =========================================.
        _________________________________________.
        LX3<>NULL:L==111XXXXX--------------------|-----------LX3----------|
        -----------------------------------------|----------------------24|
        -----------------------------------------|-------1-------2-------3|
        =========================================.
        _________________________________________.
        LX4<>NULL:L==1111XXXX--------------------|--------------LX4---------------|
        -----------------------------------------|------------------------------32|
        -----------------------------------------|-------1-------2-------3-------4|
        =========================================.
        _________________________________________.
        KIX==NULL:KI<>1XXXXXXX-------------------|?-LX-?|
        =========================================.
        _________________________________________.
        KIX1<>NULL:KI==1XXXXXXX------------------|?-LX-?|--KIX1--|
        -----------------------------------------|?-LX-?|-------8|
        -----------------------------------------|?-LX-?|-------1|
        =========================================.
        _________________________________________.
        KIX2<>NULL:KI==11XXXXXX------------------|?-LX-?|------KIX2------|
        -----------------------------------------|?-LX-?|--------------16|
        -----------------------------------------|?-LX-?|-------1-------2|
        =========================================.
        _________________________________________.
        KIX3<>NULL:KI==111XXXXX------------------|?-LX-?|----------KIX3----------|
        -----------------------------------------|?-LX-?|----------------------24|
        -----------------------------------------|?-LX-?|-------1-------2-------3|
        =========================================.
        _________________________________________.
        KIX4<>NULL:KI==1111XXXX------------------|?-LX-?|-------------KIX4---------------|
        -----------------------------------------|?-LX-?|------------------------------32|
        -----------------------------------------|?-LX-?|-------1-------2-------3-------4|
        =========================================.
        _________________________________________.
        IV==96:S==00-----------------------------|?-LX-?|?-KIX-?|----------------------------------------IV00----------------------------------------------------|
        -----------------------------------------|?-LX-?|?-KIX-?|----------------------------------------------------------------------------------------------96|
        -----------------------------------------|?-LX-?|?-KIX-?|-------1-------2-------3-------4-------5-------6-------7-------8-------9------10------11------12|
        =========================================.
        _________________________________________.
        IV==128:S==01----------------------------|?-LX-?|?-KIX-?|----------------------------------------------------IV01------------------------------------------------------------------------|
        -----------------------------------------|?-LX-?|?-KIX-?|-----------------------------------------------------------------------------------------------------------------------------128|
        -----------------------------------------|?-LX-?|?-KIX-?|-------1-------2-------3-------4-------5-------6-------7-------8-------9------10------11------12------13-------14-----15------16|
        =========================================.
        _________________________________________.
        ?-LX-?|?-KIX-?|--IV(00 ? 01)--|----------------------------------------------------MAC / TAG-------------------------------------------------------------------|
        ?-LX-?|?-KIX-?|--IV(00 ? 01)--|-----------------------------------------------------------------------------------------------------------------------------128|
        ?-LX-?|?-KIX-?|--IV(00 ? 01)--|-------1-------2-------3-------4-------5-------6-------7-------8-------9------10------11------12------13-------14-----15------16|
        =========================================.
    _________________________________________.
    VX<>NULL:V==111--------------------------|(NOT IMPLEMENTED)
    ==========================================
*/
    public struct Header {
        public enum Encoding {Bin}
        public readonly byte[] Data;
        public Header(byte[] data) {
            Data = data;
        }
        // public static void HeadReader(
        //     out Encoding encoding
        //     , out int version
        //     , out int length
        //     , out int keyId
        //     , out int ivStart
        //     , out int ivEnd
        //     , out int macStart
        //     , out int macEnd
        //     , out int dataStart
        // ) {
        //     if()
        // }
    }
}